language: ruby

rvm:
  - 2.5.0

services:
  - postgresql

before_script:
  - bundle install
  - psql -c 'create database pgapp_test;' -U postgres
  - bin/rails db:migrate
  
dist: trusty

script:
  - bundle exec rspec

  deploy:
  provider: heroku
  api_key:
    secure: KEY
  app: https://undefinedmethodbook.herokuapp.com/
  on:
    repo: Kittaru87/acebook-theUndefinedMethod

